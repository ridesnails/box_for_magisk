# Box for Magisk å·¥ä½œæµæ€»ç»“

## ğŸ¯ å·¥ä½œæµæ¦‚è¿°

æœ¬å·¥ä½œæµæä¾›äº†ä¸€ä¸ªå®Œæ•´çš„è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆï¼Œå®ç°äº†æ‚¨è¦æ±‚çš„æ‰€æœ‰åŠŸèƒ½ï¼š

### âœ… å·²å®ç°çš„åŠŸèƒ½

1. **é»˜è®¤è¿è¡Œæ¨¡å¼é…ç½®**
   - âœ… ä½¿ç”¨ sing-box æ ¸å¿ƒä½œä¸ºé»˜è®¤é€‰æ‹©
   - âœ… è‡ªåŠ¨æ£€æµ‹æœ¬åœ°æ ¸å¿ƒï¼Œä¸å­˜åœ¨æ—¶ä¸‹è½½ beta ç‰ˆæœ¬
   - âœ… é…ç½® enhance ç½‘ç»œæ¨¡å¼ï¼ˆå¢å¼ºæ¨¡å¼ï¼‰
   - âœ… è®¾ç½®é»‘åå•é€æ˜ä»£ç†è§„åˆ™
   - âœ… é›†æˆ zashboard UI æ›¿ä»£é»˜è®¤ yacd

2. **Magisk æ¨¡å—åŒ…ç”Ÿæˆ**
   - âœ… è‡ªåŠ¨æ‰“åŒ…ç”Ÿæˆå®Œæ•´çš„ Magisk æ¨¡å—
   - âœ… åŒ…å«æ‰€æœ‰å¿…è¦çš„é…ç½®æ–‡ä»¶å’Œè„šæœ¬
   - âœ… æ”¯æŒç‰ˆæœ¬ç®¡ç†å’Œè‡ªåŠ¨ç¼–å·

3. **Telegram Bot æ¨é€**
   - âœ… åŸºäºç°æœ‰ taamarinbot.py å®ç°æ¨é€åŠŸèƒ½
   - âœ… æ”¯æŒç¯å¢ƒå˜é‡é…ç½®
   - âœ… è‡ªåŠ¨æ¨é€åˆ°æŒ‡å®šé¢‘é“å’Œè¯é¢˜

## ğŸ“ ç”Ÿæˆçš„æ–‡ä»¶ç»“æ„

```
box_for_magisk/
â”œâ”€â”€ workflow_generator.sh    # ä¸»å·¥ä½œæµè„šæœ¬ (593 è¡Œ)
â”œâ”€â”€ quick_setup.sh          # å¿«é€Ÿè®¾ç½®è„šæœ¬ (è®¾å¤‡ç«¯ä½¿ç”¨)
â”œâ”€â”€ test_workflow.sh        # æµ‹è¯•éªŒè¯è„šæœ¬
â”œâ”€â”€ WORKFLOW_GUIDE.md       # è¯¦ç»†ä½¿ç”¨æŒ‡å—
â”œâ”€â”€ WORKFLOW_README.md      # å¿«é€Ÿå¼€å§‹æ–‡æ¡£
â”œâ”€â”€ EXAMPLES.md            # ä½¿ç”¨ç¤ºä¾‹é›†åˆ
â””â”€â”€ WORKFLOW_SUMMARY.md    # æœ¬æ€»ç»“æ–‡æ¡£
```

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### 1. é»˜è®¤è¿è¡Œæ¨¡å¼è¯¦è§£

**æ ¸å¿ƒé…ç½®**:
- **é»˜è®¤æ ¸å¿ƒ**: sing-box (beta ç‰ˆæœ¬)
- **å®‰è£…ä½ç½®**: `/data/adb/box/bin/sing-box`
- **æƒé™è®¾ç½®**: 6755 (setuid + setgid)
- **ç”¨æˆ·ç»„**: root:net_admin

**ç½‘ç»œæ¨¡å¼ - enhance**:
```
TCP æµé‡ â†’ redirect æ¨¡å¼ (ç«¯å£ 9797)
UDP æµé‡ â†’ tproxy æ¨¡å¼ (ç«¯å£ 9898)
```
è¿™ç§ç»„åˆæä¾›æœ€ä½³çš„å…¼å®¹æ€§å’Œæ€§èƒ½å¹³è¡¡ã€‚

**é€æ˜ä»£ç† - é»‘åå•æ¨¡å¼**:
```
é»˜è®¤è¡Œä¸º: æ‰€æœ‰åº”ç”¨é€šè¿‡ä»£ç†
é…ç½®æ–‡ä»¶: /data/adb/box/package.list.cfg
æ¨¡å¼è®¾ç½®: mode:blacklist
```

**UI ç•Œé¢ - zashboard**:
- **ä¸‹è½½æº**: https://github.com/Zephyruso/zashboard/archive/refs/heads/gh-pages.zip
- **å®‰è£…ä½ç½®**: `/data/adb/box/sing-box/dashboard`
- **è®¿é—®åœ°å€**: http://127.0.0.1:9090/ui/

### 2. è‡ªåŠ¨åŒ–å·¥ä½œæµç¨‹

```mermaid
graph TD
    A[å¼€å§‹] --> B[æ£€æŸ¥ä¾èµ–]
    B --> C[åˆå§‹åŒ–å·¥ä½œç©ºé—´]
    C --> D[é…ç½®é»˜è®¤è®¾ç½®]
    D --> E{æ£€æŸ¥æ ¸å¿ƒ}
    E -->|ä¸å­˜åœ¨| F[ä¸‹è½½ sing-box beta]
    E -->|å­˜åœ¨| G[è·³è¿‡ä¸‹è½½]
    F --> H[ä¸‹è½½ zashboard UI]
    G --> H
    H --> I[æ›´æ–° webroot é…ç½®]
    I --> J[ç”Ÿæˆæ¨¡å—åŒ…]
    J --> K{æ¨é€è®¾ç½®}
    K -->|å¯ç”¨| L[æ¨é€åˆ° Telegram]
    K -->|ç¦ç”¨| M[ä»…ä¿å­˜æœ¬åœ°]
    L --> N[æ¸…ç†ä¸´æ—¶æ–‡ä»¶]
    M --> N
    N --> O[å®Œæˆ]
```

## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨
```bash
# 1. è®¾ç½®æƒé™
chmod +x workflow_generator.sh

# 2. ä½¿ç”¨é»˜è®¤é…ç½®
./workflow_generator.sh

# 3. è®¾å¤‡ç«¯å¿«é€Ÿé…ç½®
su -c './quick_setup.sh'
```

### é«˜çº§é…ç½®
```bash
# è‡ªå®šä¹‰æ ¸å¿ƒå’Œæ¨¡å¼
./workflow_generator.sh --core clash --mode tproxy --ui yacd

# ä»…ç”Ÿæˆæ¨¡å—åŒ…
./workflow_generator.sh --build-only

# è·³è¿‡ç‰¹å®šæ­¥éª¤
./workflow_generator.sh --skip-core --skip-ui
```

### Telegram æ¨é€é…ç½®
```bash
export API_ID="your_api_id"
export API_HASH="your_api_hash"
export BOT_TOKEN="your_bot_token"
./workflow_generator.sh
```

## ğŸ“Š æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. æ¶æ„æ£€æµ‹å’Œé€‚é…
```bash
# æ”¯æŒçš„æ¶æ„æ˜ å°„
aarch64 â†’ arm64
armv7l/armv8l â†’ armv7  
x86_64 â†’ amd64
i386 â†’ 386
```

### 2. ç‰ˆæœ¬ç®¡ç†
```bash
# è‡ªåŠ¨è·å–æœ€æ–° beta ç‰ˆæœ¬
curl -s "https://api.github.com/repos/SagerNet/sing-box/releases" | \
grep -E '"tag_name".*"v.*-beta\.' | head -1
```

### 3. é…ç½®æ–‡ä»¶ç®¡ç†
```bash
# settings.ini å…³é”®é…ç½®
bin_name="sing-box"
network_mode="enhance"
ipv6="false"
box_user_group="root:net_admin"

# package.list.cfg ä»£ç†è§„åˆ™
mode:blacklist

# ap.list.cfg ç½‘ç»œæ¥å£
allow ap+
allow wlan+
```

### 4. UI é›†æˆ
```bash
# zashboard ä¸‹è½½å’Œé…ç½®
curl -L "https://github.com/Zephyruso/zashboard/archive/refs/heads/gh-pages.zip"
unzip â†’ /data/adb/box/sing-box/dashboard/
```

## ğŸ”§ é…ç½®é€‰é¡¹

### æ”¯æŒçš„æ ¸å¿ƒ
- `sing-box` (é»˜è®¤ï¼Œæ¨è)
- `clash` (mihomo)
- `xray`
- `v2fly`
- `hysteria`

### æ”¯æŒçš„ç½‘ç»œæ¨¡å¼
- `enhance` (é»˜è®¤ï¼Œæ¨è)
- `tproxy`
- `redirect`
- `mixed`
- `tun`

### æ”¯æŒçš„ä»£ç†æ¨¡å¼
- `blacklist` (é»˜è®¤ï¼Œæ¨è)
- `whitelist`

### æ”¯æŒçš„ UI
- `zashboard` (é»˜è®¤ï¼Œæ¨è)
- `yacd`
- `metacubexd`

## ğŸ§ª æµ‹è¯•å’ŒéªŒè¯

### æµ‹è¯•è„šæœ¬
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
./test_workflow.sh

# æµ‹è¯•é¡¹ç›®åŒ…æ‹¬:
# - è„šæœ¬è¯­æ³•æ£€æŸ¥
# - å‚æ•°è§£æéªŒè¯
# - ä¾èµ–æ£€æŸ¥åŠŸèƒ½
# - é…ç½®æ–‡ä»¶ç”Ÿæˆ
# - ç½‘ç»œè¿æ¥æµ‹è¯•
# - æ–‡ä»¶æ“ä½œæµ‹è¯•
```

### éªŒè¯æ­¥éª¤
1. **è¯­æ³•éªŒè¯**: æ‰€æœ‰è„šæœ¬é€šè¿‡ bash è¯­æ³•æ£€æŸ¥
2. **åŠŸèƒ½æµ‹è¯•**: æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ç‹¬ç«‹æµ‹è¯•
3. **é›†æˆæµ‹è¯•**: å®Œæ•´å·¥ä½œæµç«¯åˆ°ç«¯æµ‹è¯•
4. **å…¼å®¹æ€§æµ‹è¯•**: å¤šæ¶æ„å’Œç¯å¢ƒæµ‹è¯•

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### 1. ä¸‹è½½ä¼˜åŒ–
- æ”¯æŒ curl å’Œ wget åŒé‡å¤‡é€‰
- è‡ªåŠ¨é€‰æ‹©æœ€å¿«çš„ä¸‹è½½æ–¹å¼
- æ”¯æŒä»£ç†å’Œé•œåƒåŠ é€Ÿ

### 2. å­˜å‚¨ä¼˜åŒ–
- ä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨æ¸…ç†
- å‹ç¼©åŒ…ä¼˜åŒ–æ’é™¤ä¸å¿…è¦æ–‡ä»¶
- æ”¯æŒå¢é‡æ›´æ–°

### 3. ç½‘ç»œä¼˜åŒ–
- enhance æ¨¡å¼æä¾›æœ€ä½³æ€§èƒ½å¹³è¡¡
- æ™ºèƒ½ç«¯å£åˆ†é…é¿å…å†²çª
- IPv6 é»˜è®¤ç¦ç”¨æé«˜å…¼å®¹æ€§

## ğŸ”’ å®‰å…¨è€ƒè™‘

### 1. æƒé™ç®¡ç†
- è„šæœ¬éœ€è¦é€‚å½“æƒé™æ‰§è¡Œ
- æ ¸å¿ƒæ–‡ä»¶è®¾ç½®æ­£ç¡®çš„ setuid/setgid
- ç”¨æˆ·ç»„é…ç½®éµå¾ªæœ€å°æƒé™åŸåˆ™

### 2. ç½‘ç»œå®‰å…¨
- æ‰€æœ‰ä¸‹è½½ä½¿ç”¨ HTTPS
- éªŒè¯ä¸‹è½½æ–‡ä»¶å®Œæ•´æ€§
- æ”¯æŒä»£ç†ç¯å¢ƒä¸‹è½½

### 3. é…ç½®å®‰å…¨
- æ•æ„Ÿä¿¡æ¯ä½¿ç”¨ç¯å¢ƒå˜é‡
- é…ç½®æ–‡ä»¶æƒé™æ§åˆ¶
- å¤‡ä»½æœºåˆ¶é˜²æ­¢é…ç½®ä¸¢å¤±

## ğŸš€ éƒ¨ç½²å»ºè®®

### å¼€å‘ç¯å¢ƒ
```bash
# å®Œæ•´åŠŸèƒ½æµ‹è¯•
./workflow_generator.sh --core sing-box --ui zashboard
```

### ç”Ÿäº§ç¯å¢ƒ
```bash
# ç¨³å®šæ€§ä¼˜å…ˆ
./workflow_generator.sh --core xray --mode redirect --ui yacd
```

### CI/CD ç¯å¢ƒ
```bash
# è‡ªåŠ¨åŒ–æ„å»º
./workflow_generator.sh --build-only
```

## ğŸ“ æ”¯æŒå’Œåé¦ˆ

### é—®é¢˜æ’æŸ¥
1. æŸ¥çœ‹è¯¦ç»†æ—¥å¿—è¾“å‡º
2. è¿è¡Œæµ‹è¯•è„šæœ¬éªŒè¯
3. æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œæƒé™
4. å‚è€ƒæ•…éšœæ’é™¤æ–‡æ¡£

### è·å–å¸®åŠ©
- **è¯¦ç»†æ–‡æ¡£**: `WORKFLOW_GUIDE.md`
- **ä½¿ç”¨ç¤ºä¾‹**: `EXAMPLES.md`
- **å¿«é€Ÿå¼€å§‹**: `WORKFLOW_README.md`
- **å®˜æ–¹æ”¯æŒ**: https://t.me/taamarin

## ğŸ‰ æ€»ç»“

è¿™ä¸ªå·¥ä½œæµå®Œå…¨å®ç°äº†æ‚¨çš„éœ€æ±‚ï¼š

1. âœ… **é»˜è®¤è¿è¡Œæ¨¡å¼**: sing-box + enhance + é»‘åå• + zashboard
2. âœ… **è‡ªåŠ¨æ ¸å¿ƒç®¡ç†**: æ£€æµ‹æœ¬åœ°ï¼Œä¸å­˜åœ¨åˆ™ä¸‹è½½ beta ç‰ˆæœ¬
3. âœ… **æ¨¡å—åŒ…ç”Ÿæˆ**: å®Œæ•´çš„ Magisk æ¨¡å—è‡ªåŠ¨æ‰“åŒ…
4. âœ… **Telegram æ¨é€**: åŸºäºç°æœ‰è„šæœ¬çš„è‡ªåŠ¨æ¨é€åŠŸèƒ½

å·¥ä½œæµå…·æœ‰é«˜åº¦çš„å¯é…ç½®æ€§å’Œæ‰©å±•æ€§ï¼Œæ”¯æŒå¤šç§ä½¿ç”¨åœºæ™¯ï¼Œä»ç®€å•çš„ä¸€é”®ç”Ÿæˆåˆ°å¤æ‚çš„ CI/CD é›†æˆéƒ½èƒ½å¾ˆå¥½åœ°æ”¯æŒã€‚

**ç«‹å³å¼€å§‹ä½¿ç”¨**:
```bash
chmod +x workflow_generator.sh
./workflow_generator.sh --help
```
